"use strict";(self["webpackChunknode_final"]=self["webpackChunknode_final"]||[]).push([[902],{1885:function(e,a,t){t.d(a,{HS:function(){return d},K$:function(){return p},MH:function(){return m},TV:function(){return r},TY:function(){return i},fN:function(){return c},fj:function(){return f},pY:function(){return n},td:function(){return u}});var o=t(6265),s=t.n(o);const l="https://floating-anchorage-48826.herokuapp.com",n=e=>s().post(`${l}/user/sign_up`,e),r=e=>s().post(`${l}/user/sign_in`,e),d=e=>s().post(`${l}/user/updatePassword`,e),i=()=>s().get(`${l}/user/profile`),m=e=>s().patch(`${l}/user/profile`,e),c=e=>s().get(`${l}/posts`,{params:e}),p=e=>s().get(`${l}/post/${e}`),u=e=>s().post(`${l}/post`,e),f=e=>s()["delete"](`${l}/post/${e}`)},2323:function(e,a,t){var o=t(3766),s=t(7965);a["Z"]=(0,o.Q_)("modalStore",{state:()=>({modal:{type:"",id:"",title:"",content:""}}),actions:{toggleDelModal(e){this.modal=e,this.bsModal=(0,s.$7)("delModal"),this.bsModal.show()},toggleMsgModal(e){this.modal=e,this.bsModal=(0,s.$7)("msgModal"),this.bsModal.show()},closeDelModal(){this.modal={type:"",id:"",title:"",content:""},this.bsModal.hide()}}})},4331:function(e,a,t){var o=t(1120),s=t(3766),l=t(1885),n=t(6294),r=t(7965);const d=(0,n.Z)();a["Z"]=(0,s.Q_)("userStore",{state:()=>({profile:{name:"",photo:"",gender:"",_id:""},tempProfile:{name:"",photo:"",gender:"",_id:""}}),actions:{getProfile(){d.isLoading=!0,(0,l.TY)().then((e=>{this.profile=Object.assign({},e.data.data),this.tempProfile=Object.assign({},e.data.data),d.isLoading=!1})).catch((e=>{d.pushMessage({style:"danger",content:e.response?.data?.message||"取得個人資料失敗，請重新登入"}),d.isLoading=!1,(0,r.qz)(),o.Z.push("/signin")}))},updateProfileData(e){this.profile=Object.assign({},e),this.tempProfile=Object.assign({},e)}}})},1902:function(e,a,t){t.r(a),t.d(a,{default:function(){return A}});var o=t(3396),s=t(7139);const l=(0,o._)("h1",{class:"header"},"修改個人資料",-1),n={class:"navTab"},r={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},d={class:"tab-content navTabContent",id:"nav-tabContent"},i={class:"tab-pane fade show active px-4 py-8 px-md-8",id:"nav-profile",role:"tabpanel","aria-labelledby":"nav-profile-tab"},m={key:1,class:"bgCoverRounded mx-auto mb-4 profileUserPhoto"},c={class:"mb-4"},p=(0,o._)("label",{for:"photo",class:"form-label"},"圖片連結",-1),u={class:"mb-4"},f=(0,o._)("label",{for:"nickname",class:"form-label"},"暱稱",-1),g={class:"mb-8"},b=(0,o._)("h3",{class:"mb-2 h5 fw-normal"},"性別",-1),h={class:"form-check form-check-inline me-6"},v=(0,o._)("label",{class:"form-check-label",for:"male"},"男生",-1),w={class:"form-check form-check-inline"},_=(0,o._)("label",{class:"form-check-label",for:"female"},"女生",-1),P=(0,o._)("small",{class:"d-block mb-4 text-center text-danger"},null,-1),y=["disabled"],M={class:"tab-pane fade px-4 py-8 px-md-8",id:"nav-password",role:"tabpanel","aria-labelledby":"nav-password-tab"},k={class:"mb-4"},V=(0,o._)("label",{for:"password",class:"form-label"},"密碼",-1),x={class:"mb-8"},$=(0,o._)("label",{for:"confirmed",class:"form-label"},"確認密碼",-1),C=["disabled"],W={class:"mb-5"},F={class:"text-gray-700"};function L(e,a,t,L,Z,D){const S=(0,o.up)("VField"),j=(0,o.up)("error-message"),q=(0,o.up)("VForm"),U=(0,o.up)("MsgModalComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[l,(0,o._)("nav",n,[(0,o._)("div",r,[(0,o._)("button",{class:"nav-link active",id:"nav-profile-tab","data-bs-toggle":"tab","data-bs-target":"#nav-profile",type:"button",role:"tab","aria-controls":"nav-profile","aria-selected":"true",onClick:a[0]||(a[0]=e=>D.toggleForm("profile"))}," 修改資料 "),(0,o._)("button",{class:"nav-link",id:"nav-password-tab","data-bs-toggle":"tab","data-bs-target":"#nav-password",type:"button",role:"tab","aria-controls":"nav-password","aria-selected":"false",onClick:a[1]||(a[1]=e=>D.toggleForm("password"))}," 重設密碼 ")])]),(0,o._)("div",d,[(0,o._)("div",i,[(0,o.Wm)(q,{id:"profileForm",enctype:"multipart/form-data",onSubmit:D.updateProfile,ref:"profileForm"},{default:(0,o.w5)((({errors:t,meta:l})=>[e.profile?.photo?((0,o.wg)(),(0,o.iD)("div",{key:0,class:"bgCoverRounded mx-auto mb-4",style:(0,s.j5)({backgroundImage:"url("+e.profile?.photo+")"})},null,4)):((0,o.wg)(),(0,o.iD)("div",m)),(0,o._)("div",c,[p,(0,o.Wm)(S,{type:"text",id:"photo",placeholder:"請輸入圖片連結",name:"圖片連結",class:(0,s.C_)(["form-control",{"is-invalid":t["圖片連結"]}]),rules:"url",modelValue:e.tempProfile.photo,"onUpdate:modelValue":a[2]||(a[2]=a=>e.tempProfile.photo=a),required:""},null,8,["class","modelValue"]),(0,o.Wm)(j,{name:"圖片連結",class:"invalid-feedback text-danger"})]),(0,o._)("div",u,[f,(0,o.Wm)(S,{type:"text",id:"name",placeholder:"請輸入暱稱",name:"暱稱",class:(0,s.C_)(["form-control",{"is-invalid":t["暱稱"]}]),rules:"min:2",modelValue:e.tempProfile.name,"onUpdate:modelValue":a[3]||(a[3]=a=>e.tempProfile.name=a),required:""},null,8,["class","modelValue"]),(0,o.Wm)(j,{name:"暱稱",class:"invalid-feedback text-danger"})]),(0,o._)("div",g,[b,(0,o._)("div",h,[(0,o.Wm)(S,{type:"radio",id:"male",name:"性別",class:"form-check-input",value:"male",modelValue:e.tempProfile.gender,"onUpdate:modelValue":a[4]||(a[4]=a=>e.tempProfile.gender=a)},null,8,["modelValue"]),v]),(0,o._)("div",w,[(0,o.Wm)(S,{type:"radio",id:"female",name:"性別",class:"form-check-input",value:"female",modelValue:e.tempProfile.gender,"onUpdate:modelValue":a[5]||(a[5]=a=>e.tempProfile.gender=a)},null,8,["modelValue"]),_])]),P,(0,o._)("button",{type:"submit",class:"effectBtn btn btn-primary w-100",disabled:!l.valid}," 送出更新 ",8,y)])),_:1},8,["onSubmit"])]),(0,o._)("div",M,[(0,o.Wm)(q,{onSubmit:D.updatePassword,ref:"passwordForm"},{default:(0,o.w5)((({errors:e,meta:t})=>[(0,o._)("div",k,[V,(0,o.Wm)(S,{type:"password",id:"password",placeholder:"請輸入密碼",name:"密碼",class:(0,s.C_)(["form-control",{"is-invalid":e["密碼"]}]),rules:"required|password:8",modelValue:Z.tempPassword.password,"onUpdate:modelValue":a[6]||(a[6]=e=>Z.tempPassword.password=e),required:""},null,8,["class","modelValue"]),(0,o.Wm)(j,{name:"密碼",class:"invalid-feedback text-danger"})]),(0,o._)("div",x,[$,(0,o.Wm)(S,{type:"password",id:"confirmed",placeholder:"請再次輸入密碼",name:"確認密碼",class:(0,s.C_)(["form-control",{"is-invalid":e["確認密碼"]}]),rules:"required|confirmed:@密碼",modelValue:Z.tempPassword.confirmPassword,"onUpdate:modelValue":a[7]||(a[7]=e=>Z.tempPassword.confirmPassword=e),required:""},null,8,["class","modelValue"]),(0,o.Wm)(j,{name:"確認密碼",class:"invalid-feedback text-danger"})]),(0,o._)("button",{type:"submit",class:"effectBtn btn btn-primary w-100",disabled:!t.valid}," 重設密碼 ",8,C)])),_:1},8,["onSubmit"])])]),(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o._)("h3",W,(0,s.zw)(e.modal.title),1),(0,o._)("p",F,(0,s.zw)(e.modal.content),1)])),_:1})],64)}var Z=t(1885);const D={class:"modal fade",id:"msgModal",tabindex:"-1","aria-labelledby":"msgModalLabel","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-hidden":"false"},S={class:"modal-dialog modal-dialog-centered"},j={class:"modal-content"},q={class:"modal-body pb-0 text-center"},U=(0,o._)("div",{class:"modal-footer justify-content-center"},[(0,o._)("button",{type:"button",class:"btn btn-primary py-2 px-8","data-bs-dismiss":"modal"}," 確定 ")],-1);function H(e,a,t,s,l,n){return(0,o.wg)(),(0,o.iD)("div",D,[(0,o._)("div",S,[(0,o._)("div",j,[(0,o._)("div",q,[(0,o.WI)(e.$slots,"default")]),U])])])}var T={name:"MsgModalComponent"},O=t(89);const Y=(0,O.Z)(T,[["render",H]]);var z=Y,B=t(3766),I=t(6294),Q=t(4331),R=t(2323),K={name:"ProfileView",data(){return{tempPassword:{password:"",confirmPassword:""}}},methods:{toggleForm(e){"profile"==e?this.$refs.passwordForm.resetForm():this.getProfile()},updateProfile(){this.toggleLoading(!0),(0,Z.MH)(this.tempProfile).then((e=>{this.updateProfileData(e.data.data.user),this.toggleMsgModal({title:"更新個人資料",content:"已成功更新您的個人資料~"}),this.toggleLoading(!1)})).catch((e=>{this.pushMessage({style:"danger",content:e.response?.data?.message||"更新失敗"}),this.toggleLoading(!1)}))},updatePassword(){this.toggleLoading(!0),(0,Z.HS)(this.tempPassword).then((()=>{this.$refs.passwordForm.resetForm(),this.toggleMsgModal({title:"更新密碼成功",content:"下次登入記得使用新密碼喔~"}),this.toggleLoading(!1)})).catch((e=>{this.pushMessage({style:"danger",content:e.response?.data?.message||"更新密碼失敗"}),this.toggleLoading(!1)}))},...(0,B.nv)(I.Z,["pushMessage","toggleLoading"]),...(0,B.nv)(Q.Z,["getProfile","updateProfileData"]),...(0,B.nv)(R.Z,["toggleMsgModal"])},computed:{...(0,B.rn)(Q.Z,["profile","tempProfile"]),...(0,B.rn)(R.Z,["modal"])},components:{MsgModalComponent:z}};const N=(0,O.Z)(K,[["render",L]]);var A=N}}]);
//# sourceMappingURL=902.8700b623.js.map